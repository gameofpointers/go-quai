syntax = "proto3";

package block;
option go_package = "github.com/dominant-strategies/go-quai/core/types";

import "common/proto_common.proto";

// This file defines all the ProtoBuf definitions related to core
message ProtoBlock {
  optional ProtoHeader header = 1;
  optional ProtoBody body = 2;
}

message ProtoBody {
  optional ProtoTransactions txs = 1;
  optional ProtoHeaders uncles = 2;
  optional ProtoTransactions etxs = 3;
  optional ProtoManifest manifest = 4;
}

message ProtoHeader {
  repeated common.ProtoHash parent_hash = 1;
  optional common.ProtoHash uncle_hash = 2;
  optional bytes coinbase = 3;
  optional common.ProtoHash evm_root = 4;
  optional common.ProtoHash tx_hash = 5;
  optional common.ProtoHash etx_hash = 6;
  optional common.ProtoHash etx_rollup_hash = 7;
  repeated common.ProtoHash manifest_hash = 8;
  optional common.ProtoHash receipt_hash = 9;
  repeated bytes parent_entropy = 10;
  repeated bytes parent_delta_s = 11;
  repeated bytes number = 12;
  optional uint64 gas_limit = 13;
  optional uint64 gas_used = 14;
  optional bytes base_fee = 15;
  optional uint64 time = 16;
  optional bytes extra = 17;
  optional common.ProtoHash utxo_root = 18;
  optional common.ProtoHash etx_set_hash = 19;
}

message ProtoTransaction {
  optional uint64 type = 1;
  optional bytes to = 2;
  optional uint64 nonce = 3;
  optional bytes value = 4;
  optional uint64 gas = 5;
  optional bytes data = 6;
  optional bytes chain_id = 7;
  optional bytes gas_fee_cap = 8;
  optional bytes gas_tip_cap = 9;
  optional ProtoAccessList access_list = 10;
  optional uint64 etx_gas_limit = 11;
  optional bytes etx_gas_price = 12;
  optional bytes etx_gas_tip = 13;
  optional bytes etx_data = 14;
  optional ProtoAccessList etx_access_list = 15;
  optional bytes v = 16;
  optional bytes r = 17;
  optional bytes s = 18;
  optional common.ProtoHash originating_tx_hash = 19;
  optional uint32 etx_index = 20;
  optional bytes etx_sender = 21;
  optional ProtoTxIns tx_ins = 22;
  optional ProtoTxOuts tx_outs = 23;
  optional bytes signature = 24;
}

message ProtoTransactions { repeated ProtoTransaction transactions = 1; }

message ProtoHeaders { repeated ProtoHeader headers = 1; }

message ProtoManifest { repeated common.ProtoHash manifest = 1; }

message ProtoAccessList { repeated ProtoAccessTuple access_tuples = 1; }

message ProtoWorkObjectHeader {
  optional common.ProtoHash header_hash = 1;
  optional common.ProtoHash parent_hash = 2;
  optional bytes number = 3;
  optional bytes difficulty = 4;
  optional common.ProtoHash tx_hash = 5;
  optional uint64 nonce = 6;
  optional common.ProtoLocation location = 7;
  optional common.ProtoHash mix_hash = 8;
}

message ProtoWorkObjectBody {
  optional ProtoHeader header = 1;
  optional ProtoWorkObjects transactions = 2;
  optional ProtoWorkObjects ext_transactions = 3;
  optional ProtoWorkObjects uncles = 4;
  optional ProtoManifest manifest = 5;
}

message ProtoWorkObject {
  optional ProtoWorkObjectHeader wo_header = 1;
  optional ProtoWorkObjectBody wo_body = 2;
  optional ProtoTransaction tx = 3;
}

message ProtoWorkObjects { repeated ProtoWorkObject work_objects = 1; }

message ProtoAccessTuple {
  bytes address = 1;
  repeated common.ProtoHash storage_key = 2;
}

message ProtoReceiptForStorage {
  bytes post_state_or_status = 1;
  uint64 cumulative_gas_used = 2;
  common.ProtoHash tx_hash = 3;
  common.ProtoAddress contract_address = 4;
  ProtoLogsForStorage logs = 5;
  ProtoWorkObjects etxs = 6;
  uint64 gas_used = 7;
}

message ProtoReceiptsForStorage {
  repeated ProtoReceiptForStorage receipts = 1;
}

message ProtoReceiptConsensus {
  bytes post_state_or_status = 1;
  uint64 cumulative_gas_used = 2;
  bytes bloom = 3;
  ProtoLogsForStorage logs = 4;
  ProtoWorkObjects etxs = 5;
}

message ProtoReceiptsConsensus { repeated ProtoReceiptConsensus receipts = 1; }

message ProtoLogForStorage {
  common.ProtoAddress address = 1;
  repeated common.ProtoHash topics = 2;
  bytes data = 3;
}

message ProtoLogsForStorage { repeated ProtoLogForStorage logs = 1; }

message ProtoPendingHeader {
  optional ProtoWorkObject wo = 1;
  optional ProtoTermini termini = 2;
}

message ProtoTermini {
  repeated common.ProtoHash dom_termini = 1;
  repeated common.ProtoHash sub_termini = 2;
}

message ProtoEtxSet { optional bytes etx_hashes = 1; }

message ProtoPendingEtxs {
  optional ProtoWorkObject header = 1;
  optional ProtoWorkObjects etxs = 2;
}

message ProtoPendingEtxsRollup {
  optional ProtoWorkObject header = 1;
  optional ProtoWorkObjects etxs_rollup = 2;
}

message ProtoTxIns { repeated ProtoTxIn tx_ins = 1; }

message ProtoTxOuts { repeated ProtoTxOut tx_outs = 1; }

message ProtoTxIn {
  optional ProtoOutPoint previous_out_point = 1;
  optional bytes pub_key = 2;
}

message ProtoOutPoint {
  optional common.ProtoHash hash = 1;
  optional uint32 index = 2;
}

message ProtoTxOut {
  optional uint32 denomination = 1;
  optional bytes address = 2;
}
